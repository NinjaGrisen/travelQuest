extends layout

include mixins/_questCard
include mixins/_pagination


block content
    .inner
        h2.quests--layout-option #{title}
        .quests
            each quest, index in quests
                if index < 1
                    a(href=`/quest/${quest.slug}`)
                        .quest
                            .quest__hero(style=`background-image: url(/uploads/quest/${quest.photo || 'store.png'})`)
                                .quest__actions
                                    if user
                                        .quest__action.quest__action--heart
                                            form.heart(method="POST" action=`/api/quests/${quest._id}/heart`)
                                                - const heartStrings = user.bookmarked.map(obj => obj.toString())
                                                - const heartClass = heartStrings.includes(quest._id.toString()) ? 'heart__button--hearted': ''
                                                button.heart__button(type="submit" name="heart" class=heartClass) 
                                                    span.heart__button--hearted--inactive ☆
                                                    span.heart__button--hearted--active ★
                                
                            .quest__details
                                h2.title #{quest.name}
                                if index != null
                                    if index === 0
                                        .quest__info
                                            p= quest.description.split(' ').slice(0,15).join(' ').concat('...')
                                    else 
                                        .quest__info
                                            p= quest.description.split(' ').slice(0,15).join(' ').concat('...')
        .quests.quests--layout-option
            each quest, index in quests
                if index > 0
                    +questCard(quest, index)

        +pagination(page, pages, count, '/quests/page')
